{"ast":null,"code":"import { SIGNUP_SUCCESS, SIGNUP_ERROR, SIGNIN_SUCCESS, SIGNIN_ERROR, EMAIL_NOT_VERIFIED, SIGNOUT_SUCCESS, SIGNOUT_ERROR, RESET_SUCCESS, RESET_ERROR } from \"./actionTypes\";\nimport { beginApiCall, apiCallError } from \"./apiStatus\";\nimport firebase from \"../../Config/fbConfig\"; // Signing up with Firebase\n\nexport const signup = (email, password, username) => async dispatch => {\n  try {\n    dispatch(beginApiCall());\n    const db = firebase.firestore().collection(\"Users\");\n    console.log(email + \" \" + username + \" \" + password);\n    firebase.auth().createUserWithEmailAndPassword(email, password).then(dataBeforeEmail => {\n      db.add({\n        Username: username,\n        Email: email\n      });\n      firebase.auth().onAuthStateChanged(function (user) {\n        user.sendEmailVerification();\n      });\n    }).then(dataAfterEmail => {\n      firebase.auth().onAuthStateChanged(function (user) {\n        if (user) {\n          // Sign up successful\n          dispatch({\n            type: SIGNUP_SUCCESS,\n            payload: \"Your account was successfully created! Please check your inbox to verify the email then login.\"\n          });\n        } else {\n          // Signup failed\n          dispatch({\n            type: SIGNUP_ERROR,\n            payload: \"Oops! We couldn't create your account. Please try again.\"\n          });\n        }\n      });\n    }).catch(() => {\n      dispatch(apiCallError());\n      dispatch({\n        type: SIGNUP_ERROR,\n        payload: \"Oops! We couldn't create your account. Please try again.\"\n      });\n    });\n  } catch (err) {\n    dispatch(apiCallError());\n    dispatch({\n      type: SIGNUP_ERROR,\n      payload: \"Oops! We couldn't create your account. Please try again.\"\n    });\n  }\n}; // Signing in with Firebase\n\nexport const signin = (email, password, callback) => async dispatch => {\n  try {\n    dispatch(beginApiCall());\n    firebase.auth().signInWithEmailAndPassword(email, password).then(data => {\n      if (data.user.emailVerified) {\n        console.log(\"IF\", data.user.emailVerified);\n        dispatch({\n          type: SIGNIN_SUCCESS\n        });\n        callback();\n      } else {\n        console.log(\"ELSE\", data.user.emailVerified);\n        dispatch({\n          type: EMAIL_NOT_VERIFIED,\n          payload: \"Please verify your email address to continue.\"\n        });\n      }\n    }).catch(() => {\n      dispatch(apiCallError());\n      dispatch({\n        type: SIGNIN_ERROR,\n        payload: \"Invalid login credentials\"\n      });\n    });\n  } catch (err) {\n    dispatch(apiCallError());\n    dispatch({\n      type: SIGNIN_ERROR,\n      payload: \"Invalid login credentials\"\n    });\n  }\n}; // Signing out with Firebase\n\nexport const signout = () => async dispatch => {\n  try {\n    dispatch(beginApiCall());\n    firebase.auth().signOut().then(() => {\n      dispatch({\n        type: SIGNOUT_SUCCESS\n      });\n    }).catch(() => {\n      dispatch(apiCallError());\n      dispatch({\n        type: SIGNOUT_ERROR,\n        payload: \"Error, we were not able to log you out. Please try again.\"\n      });\n    });\n  } catch (err) {\n    dispatch(apiCallError());\n    dispatch({\n      type: SIGNOUT_ERROR,\n      payload: \"Error, we were not able to log you out. Please try again.\"\n    });\n  }\n}; // Reset password with Firebase\n\nexport const resetPassword = email => async dispatch => {\n  try {\n    dispatch(beginApiCall());\n    firebase.auth().sendPasswordResetEmail(email).then(() => dispatch({\n      type: RESET_SUCCESS,\n      payload: \"Check your inbox. We've sent you a secured reset link by e-mail.\"\n    })).catch(() => {\n      dispatch(apiCallError());\n      dispatch({\n        type: RESET_ERROR,\n        payload: \"Oops, something went wrong we couldn't send you the e-mail. Try again and if the error persists, contact admin.\"\n      });\n    });\n  } catch (err) {\n    dispatch(apiCallError());\n    dispatch({\n      type: RESET_ERROR,\n      payload: err\n    });\n  }\n};","map":{"version":3,"sources":["C:/Users/User/Documents/GitHub/The-Amazing-App/web-app/src/store/actions/auth.js"],"names":["SIGNUP_SUCCESS","SIGNUP_ERROR","SIGNIN_SUCCESS","SIGNIN_ERROR","EMAIL_NOT_VERIFIED","SIGNOUT_SUCCESS","SIGNOUT_ERROR","RESET_SUCCESS","RESET_ERROR","beginApiCall","apiCallError","firebase","signup","email","password","username","dispatch","db","firestore","collection","console","log","auth","createUserWithEmailAndPassword","then","dataBeforeEmail","add","Username","Email","onAuthStateChanged","user","sendEmailVerification","dataAfterEmail","type","payload","catch","err","signin","callback","signInWithEmailAndPassword","data","emailVerified","signout","signOut","resetPassword","sendPasswordResetEmail"],"mappings":"AAAA,SACEA,cADF,EAEEC,YAFF,EAGEC,cAHF,EAIEC,YAJF,EAKEC,kBALF,EAMEC,eANF,EAOEC,aAPF,EAQEC,aARF,EASEC,WATF,QAUO,eAVP;AAWA,SAASC,YAAT,EAAuBC,YAAvB,QAA2C,aAA3C;AACA,OAAOC,QAAP,MAAqB,uBAArB,C,CAEA;;AACA,OAAO,MAAMC,MAAM,GAAG,CAACC,KAAD,EAAQC,QAAR,EAAkBC,QAAlB,KAA+B,MAAOC,QAAP,IAAoB;AACvE,MAAI;AACFA,IAAAA,QAAQ,CAACP,YAAY,EAAb,CAAR;AACA,UAAMQ,EAAE,GAAGN,QAAQ,CAACO,SAAT,GAAqBC,UAArB,CAAgC,OAAhC,CAAX;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAYR,KAAK,GAAG,GAAR,GAAcE,QAAd,GAAyB,GAAzB,GAA+BD,QAA3C;AACAH,IAAAA,QAAQ,CACLW,IADH,GAEGC,8BAFH,CAEkCV,KAFlC,EAEyCC,QAFzC,EAGGU,IAHH,CAGSC,eAAD,IAAqB;AACzBR,MAAAA,EAAE,CAACS,GAAH,CAAO;AACLC,QAAAA,QAAQ,EAAEZ,QADL;AAELa,QAAAA,KAAK,EAAEf;AAFF,OAAP;AAIAF,MAAAA,QAAQ,CAACW,IAAT,GAAgBO,kBAAhB,CAAmC,UAAUC,IAAV,EAAgB;AACjDA,QAAAA,IAAI,CAACC,qBAAL;AACD,OAFD;AAGD,KAXH,EAYGP,IAZH,CAYSQ,cAAD,IAAoB;AACxBrB,MAAAA,QAAQ,CAACW,IAAT,GAAgBO,kBAAhB,CAAmC,UAAUC,IAAV,EAAgB;AACjD,YAAIA,IAAJ,EAAU;AACR;AACAd,UAAAA,QAAQ,CAAC;AACPiB,YAAAA,IAAI,EAAEjC,cADC;AAEPkC,YAAAA,OAAO,EACL;AAHK,WAAD,CAAR;AAKD,SAPD,MAOO;AACL;AACAlB,UAAAA,QAAQ,CAAC;AACPiB,YAAAA,IAAI,EAAEhC,YADC;AAEPiC,YAAAA,OAAO,EACL;AAHK,WAAD,CAAR;AAKD;AACF,OAhBD;AAiBD,KA9BH,EA+BGC,KA/BH,CA+BS,MAAM;AACXnB,MAAAA,QAAQ,CAACN,YAAY,EAAb,CAAR;AACAM,MAAAA,QAAQ,CAAC;AACPiB,QAAAA,IAAI,EAAEhC,YADC;AAEPiC,QAAAA,OAAO,EAAE;AAFF,OAAD,CAAR;AAID,KArCH;AAsCD,GA1CD,CA0CE,OAAOE,GAAP,EAAY;AACZpB,IAAAA,QAAQ,CAACN,YAAY,EAAb,CAAR;AACAM,IAAAA,QAAQ,CAAC;AACPiB,MAAAA,IAAI,EAAEhC,YADC;AAEPiC,MAAAA,OAAO,EAAE;AAFF,KAAD,CAAR;AAID;AACF,CAlDM,C,CAoDP;;AACA,OAAO,MAAMG,MAAM,GAAG,CAACxB,KAAD,EAAQC,QAAR,EAAkBwB,QAAlB,KAA+B,MAAOtB,QAAP,IAAoB;AACvE,MAAI;AACFA,IAAAA,QAAQ,CAACP,YAAY,EAAb,CAAR;AACAE,IAAAA,QAAQ,CACLW,IADH,GAEGiB,0BAFH,CAE8B1B,KAF9B,EAEqCC,QAFrC,EAGGU,IAHH,CAGSgB,IAAD,IAAU;AACd,UAAIA,IAAI,CAACV,IAAL,CAAUW,aAAd,EAA6B;AAC3BrB,QAAAA,OAAO,CAACC,GAAR,CAAY,IAAZ,EAAkBmB,IAAI,CAACV,IAAL,CAAUW,aAA5B;AACAzB,QAAAA,QAAQ,CAAC;AAAEiB,UAAAA,IAAI,EAAE/B;AAAR,SAAD,CAAR;AACAoC,QAAAA,QAAQ;AACT,OAJD,MAIO;AACLlB,QAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ,EAAoBmB,IAAI,CAACV,IAAL,CAAUW,aAA9B;AACAzB,QAAAA,QAAQ,CAAC;AACPiB,UAAAA,IAAI,EAAE7B,kBADC;AAEP8B,UAAAA,OAAO,EAAE;AAFF,SAAD,CAAR;AAID;AACF,KAfH,EAgBGC,KAhBH,CAgBS,MAAM;AACXnB,MAAAA,QAAQ,CAACN,YAAY,EAAb,CAAR;AACAM,MAAAA,QAAQ,CAAC;AACPiB,QAAAA,IAAI,EAAE9B,YADC;AAEP+B,QAAAA,OAAO,EAAE;AAFF,OAAD,CAAR;AAID,KAtBH;AAuBD,GAzBD,CAyBE,OAAOE,GAAP,EAAY;AACZpB,IAAAA,QAAQ,CAACN,YAAY,EAAb,CAAR;AACAM,IAAAA,QAAQ,CAAC;AAAEiB,MAAAA,IAAI,EAAE9B,YAAR;AAAsB+B,MAAAA,OAAO,EAAE;AAA/B,KAAD,CAAR;AACD;AACF,CA9BM,C,CAgCP;;AACA,OAAO,MAAMQ,OAAO,GAAG,MAAM,MAAO1B,QAAP,IAAoB;AAC/C,MAAI;AACFA,IAAAA,QAAQ,CAACP,YAAY,EAAb,CAAR;AACAE,IAAAA,QAAQ,CACLW,IADH,GAEGqB,OAFH,GAGGnB,IAHH,CAGQ,MAAM;AACVR,MAAAA,QAAQ,CAAC;AAAEiB,QAAAA,IAAI,EAAE5B;AAAR,OAAD,CAAR;AACD,KALH,EAMG8B,KANH,CAMS,MAAM;AACXnB,MAAAA,QAAQ,CAACN,YAAY,EAAb,CAAR;AACAM,MAAAA,QAAQ,CAAC;AACPiB,QAAAA,IAAI,EAAE3B,aADC;AAEP4B,QAAAA,OAAO,EAAE;AAFF,OAAD,CAAR;AAID,KAZH;AAaD,GAfD,CAeE,OAAOE,GAAP,EAAY;AACZpB,IAAAA,QAAQ,CAACN,YAAY,EAAb,CAAR;AACAM,IAAAA,QAAQ,CAAC;AACPiB,MAAAA,IAAI,EAAE3B,aADC;AAEP4B,MAAAA,OAAO,EAAE;AAFF,KAAD,CAAR;AAID;AACF,CAvBM,C,CAyBP;;AACA,OAAO,MAAMU,aAAa,GAAI/B,KAAD,IAAW,MAAOG,QAAP,IAAoB;AAC1D,MAAI;AACFA,IAAAA,QAAQ,CAACP,YAAY,EAAb,CAAR;AACAE,IAAAA,QAAQ,CACLW,IADH,GAEGuB,sBAFH,CAE0BhC,KAF1B,EAGGW,IAHH,CAGQ,MACJR,QAAQ,CAAC;AACPiB,MAAAA,IAAI,EAAE1B,aADC;AAEP2B,MAAAA,OAAO,EACL;AAHK,KAAD,CAJZ,EAUGC,KAVH,CAUS,MAAM;AACXnB,MAAAA,QAAQ,CAACN,YAAY,EAAb,CAAR;AACAM,MAAAA,QAAQ,CAAC;AACPiB,QAAAA,IAAI,EAAEzB,WADC;AAEP0B,QAAAA,OAAO,EACL;AAHK,OAAD,CAAR;AAKD,KAjBH;AAkBD,GApBD,CAoBE,OAAOE,GAAP,EAAY;AACZpB,IAAAA,QAAQ,CAACN,YAAY,EAAb,CAAR;AACAM,IAAAA,QAAQ,CAAC;AAAEiB,MAAAA,IAAI,EAAEzB,WAAR;AAAqB0B,MAAAA,OAAO,EAAEE;AAA9B,KAAD,CAAR;AACD;AACF,CAzBM","sourcesContent":["import {\r\n  SIGNUP_SUCCESS,\r\n  SIGNUP_ERROR,\r\n  SIGNIN_SUCCESS,\r\n  SIGNIN_ERROR,\r\n  EMAIL_NOT_VERIFIED,\r\n  SIGNOUT_SUCCESS,\r\n  SIGNOUT_ERROR,\r\n  RESET_SUCCESS,\r\n  RESET_ERROR,\r\n} from \"./actionTypes\";\r\nimport { beginApiCall, apiCallError } from \"./apiStatus\";\r\nimport firebase from \"../../Config/fbConfig\";\r\n\r\n// Signing up with Firebase\r\nexport const signup = (email, password, username) => async (dispatch) => {\r\n  try {\r\n    dispatch(beginApiCall());\r\n    const db = firebase.firestore().collection(\"Users\");\r\n    console.log(email + \" \" + username + \" \" + password);\r\n    firebase\r\n      .auth()\r\n      .createUserWithEmailAndPassword(email, password)\r\n      .then((dataBeforeEmail) => {\r\n        db.add({\r\n          Username: username,\r\n          Email: email,\r\n        });\r\n        firebase.auth().onAuthStateChanged(function (user) {\r\n          user.sendEmailVerification();\r\n        });\r\n      })\r\n      .then((dataAfterEmail) => {\r\n        firebase.auth().onAuthStateChanged(function (user) {\r\n          if (user) {\r\n            // Sign up successful\r\n            dispatch({\r\n              type: SIGNUP_SUCCESS,\r\n              payload:\r\n                \"Your account was successfully created! Please check your inbox to verify the email then login.\",\r\n            });\r\n          } else {\r\n            // Signup failed\r\n            dispatch({\r\n              type: SIGNUP_ERROR,\r\n              payload:\r\n                \"Oops! We couldn't create your account. Please try again.\",\r\n            });\r\n          }\r\n        });\r\n      })\r\n      .catch(() => {\r\n        dispatch(apiCallError());\r\n        dispatch({\r\n          type: SIGNUP_ERROR,\r\n          payload: \"Oops! We couldn't create your account. Please try again.\",\r\n        });\r\n      });\r\n  } catch (err) {\r\n    dispatch(apiCallError());\r\n    dispatch({\r\n      type: SIGNUP_ERROR,\r\n      payload: \"Oops! We couldn't create your account. Please try again.\",\r\n    });\r\n  }\r\n};\r\n\r\n// Signing in with Firebase\r\nexport const signin = (email, password, callback) => async (dispatch) => {\r\n  try {\r\n    dispatch(beginApiCall());\r\n    firebase\r\n      .auth()\r\n      .signInWithEmailAndPassword(email, password)\r\n      .then((data) => {\r\n        if (data.user.emailVerified) {\r\n          console.log(\"IF\", data.user.emailVerified);\r\n          dispatch({ type: SIGNIN_SUCCESS });\r\n          callback();\r\n        } else {\r\n          console.log(\"ELSE\", data.user.emailVerified);\r\n          dispatch({\r\n            type: EMAIL_NOT_VERIFIED,\r\n            payload: \"Please verify your email address to continue.\",\r\n          });\r\n        }\r\n      })\r\n      .catch(() => {\r\n        dispatch(apiCallError());\r\n        dispatch({\r\n          type: SIGNIN_ERROR,\r\n          payload: \"Invalid login credentials\",\r\n        });\r\n      });\r\n  } catch (err) {\r\n    dispatch(apiCallError());\r\n    dispatch({ type: SIGNIN_ERROR, payload: \"Invalid login credentials\" });\r\n  }\r\n};\r\n\r\n// Signing out with Firebase\r\nexport const signout = () => async (dispatch) => {\r\n  try {\r\n    dispatch(beginApiCall());\r\n    firebase\r\n      .auth()\r\n      .signOut()\r\n      .then(() => {\r\n        dispatch({ type: SIGNOUT_SUCCESS });\r\n      })\r\n      .catch(() => {\r\n        dispatch(apiCallError());\r\n        dispatch({\r\n          type: SIGNOUT_ERROR,\r\n          payload: \"Error, we were not able to log you out. Please try again.\",\r\n        });\r\n      });\r\n  } catch (err) {\r\n    dispatch(apiCallError());\r\n    dispatch({\r\n      type: SIGNOUT_ERROR,\r\n      payload: \"Error, we were not able to log you out. Please try again.\",\r\n    });\r\n  }\r\n};\r\n\r\n// Reset password with Firebase\r\nexport const resetPassword = (email) => async (dispatch) => {\r\n  try {\r\n    dispatch(beginApiCall());\r\n    firebase\r\n      .auth()\r\n      .sendPasswordResetEmail(email)\r\n      .then(() =>\r\n        dispatch({\r\n          type: RESET_SUCCESS,\r\n          payload:\r\n            \"Check your inbox. We've sent you a secured reset link by e-mail.\",\r\n        })\r\n      )\r\n      .catch(() => {\r\n        dispatch(apiCallError());\r\n        dispatch({\r\n          type: RESET_ERROR,\r\n          payload:\r\n            \"Oops, something went wrong we couldn't send you the e-mail. Try again and if the error persists, contact admin.\",\r\n        });\r\n      });\r\n  } catch (err) {\r\n    dispatch(apiCallError());\r\n    dispatch({ type: RESET_ERROR, payload: err });\r\n  }\r\n};\r\n"]},"metadata":{},"sourceType":"module"}